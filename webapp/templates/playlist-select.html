{% extends "base.html" %} 

{% block title %}Home
{% endblock %}

{% block content %}

<main>
    <div class="playlist-select-container">
        <div class="row">
            <div class="col left">
                <img src="https://bit.ly/3PiIDrx" alt="nomePlaylist">
            </div>
            <div class="col right">
                <h6>PLAYLIST</h6>
                <h1>{{playlist_name}}</h1>
                <h5>{{num_songs}} brani, {{tot_length// 3600 }} ore {{tot_length// 60 }} minuti  </h5>
            </div>
        </div>
    </div>
    <div class="button-container">
        <div class="row">
            <div class="col">
                <i class="bi bi-play-circle-fill"></i>
            </div>
            <div class="col heart">
                <form action="" method="post" name="addPlaylistToFav">
                    <i class="bi bi-heart" onclick="changeHearticon(this)"></i>
                </form>
            </div>
            <div class="col share">
                <i class="bi bi-share-fill"></i>
            </div>
        </div>
    </div>
    <table class="content-table">
        <thead>
          <tr>
            <th>#</th>
            <th>TITOLO</th>
            <th>ALBUM</th>
            <th></th>
            <th><i class="bi bi-clock"></i></th>
          </tr>
        </thead>
        <tbody>
          {%- for song in songs_list -%}
            <tr>
              <td>{{ song.num_order }}</td>
              <td>{{ song.title }}</td>
              <td>{{ song.name }}</td>
              <td class="fav-col"><i class="bi bi-heart" onclick="changeHearticon(this)"></i></td>
              <td id='intToMinSec'> {{ song.length // 60 }}:{{ song.length % 60}} </td>
            </tr>
          {%- endfor -%}
        </tbody>
      </table>
    <script>
        function changeHearticon(icon){
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/playlists/<int:id_playlist_selected>", true);
            xhr.setRequestHeader('Content-Type', 'application/json');
            let typeIcon = null
        
            if (icon.classList.contains('bi-heart')) {
                typeIcon="addOnFav"
                icon.classList.remove("bi-heart");
                icon.classList.add("bi-heart-fill");
            } else {
                typeIcon="removeFromFav"
                icon.classList.add("bi-heart");
                icon.classList.remove("bi-heart-fill");
            }
            xhr.send(JSON.stringify({
                value: typeIcon
            }));
        }
    </script>
</main>

{% endblock %}

